(this["webpackJsonpchord-practice"]=this["webpackJsonpchord-practice"]||[]).push([[0],{15:function(e,t,a){var n=a(28),i=[];e.exports=function(){var e=new Worker(a.p+"118dfcd48df09c891a63.worker.js",{name:"[hash].worker.js"});return n(e,i),e}},22:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a(4),s=a(5),c=a(7),r=a(6),o=a(2),h=a.n(o),l=a(14),d=a.n(l),u=(a(21),a(22),a(8)),m=a(16),j=a(15),p=a.n(j),b=a(9),k=a(0),v=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).canvasRef=h.a.createRef(),i.resetCanvas=i.resetCanvas.bind(Object(s.a)(i)),window.onorientationchange=i.resetCanvas,window.onresize=i.resetCanvas,i.curNote=null,i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.resetCanvas()}},{key:"componentDidUpdate",value:function(){this.drawCanvas()}},{key:"resetCanvas",value:function(){this.canvasRef.current.width=window.innerWidth,window.scrollTo(0,0),this.drawCanvas()}},{key:"drawCanvas",value:function(){var e=this.canvasRef.current,t=e.getContext("2d");t.fillStyle=this.props.theme.background,t.fillRect(0,0,e.width,e.height);for(var a=Math.min(e.width/this.props.beatsPerBar/5,36),n=0;n<this.props.beatsPerBar;n++){var i,s;t.fillStyle=this.props.theme.light,t.shadowBlur=0,(null===(i=this.props.curNote)||void 0===i?void 0:i.beat)===n&&0===this.props.curNote.click&&(this.curNote=this.props.curNote),(null===(s=this.curNote)||void 0===s?void 0:s.beat)===n&&(this.props.isplaying?(t.fillStyle="red",t.shadowColor="red",t.shadowBlur=a):this.curNote=null),t.beginPath(),t.arc(n*(e.width/this.props.beatsPerBar)+e.width/this.props.beatsPerBar/2,e.height/2,a,0,2*Math.PI),t.fill()}}},{key:"render",value:function(){return Object(k.jsx)("div",{className:"visualizer",children:Object(k.jsx)("canvas",{ref:this.canvasRef,id:"canvas",height:"100",width:"100"})})}}]),a}(h.a.Component),C=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={lastNoteDrawn:null,curNote:null},i.updateAnimation=i.updateAnimation.bind(Object(s.a)(i)),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.rAF=requestAnimationFrame(this.updateAnimation)}},{key:"updateAnimation",value:function(){if(this.props.isplaying){for(var e=this.props.audiocontext.currentTime,t=this.props.queue,a=this.state.lastNoteDrawn;t.length&&t[0].time<e;)a=t[0],t.splice(0,1);this.setState((function(){return{curNote:a}}))}this.rAF=requestAnimationFrame(this.updateAnimation)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rAF)}},{key:"render",value:function(){return Object(k.jsx)(v,{isplaying:this.props.isplaying,beatsPerBar:this.props.beatsPerBar,curNote:this.state.curNote,theme:this.props.theme})}}]),a}(h.a.Component),x=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(n.a)(this,a),t.call(this,e)}return Object(i.a)(a,[{key:"render",value:function(){return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("div",{className:"tempo-input-row",children:Object(k.jsx)("div",{style:{textAlign:"center",width:"100%",fontSize:"5rem"},children:Object(k.jsx)("b",{children:this.props.chord})})}),Object(k.jsxs)("div",{className:"tempo-input-row",children:[Object(k.jsx)("button",{name:"decrement-tempo",onClick:this.props.onClick,className:"btn-circle",children:"\u2013"}),Object(k.jsxs)("div",{className:"tempo-label",children:[Object(k.jsx)("span",{id:"tempo-label",children:this.props.tempo}),Object(k.jsx)("span",{className:"bpm-label",children:"\xa0bpm"})]}),Object(k.jsx)("button",{name:"increment-tempo",onClick:this.props.onClick,className:"btn-circle",children:"+"})]}),Object(k.jsx)("div",{className:"slider-row",children:Object(k.jsx)("input",{type:"range",id:"tempo",min:this.props.minTempo,max:this.props.maxTempo,step:"1",value:this.props.tempo,onChange:this.props.onChange})})]})}}]),a}(h.a.Component),g=["A","B","C","D","E","F","G"],O=["Am","Bm","Cm","Dm","Em","Fm","Gm"],f=Object(i.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(n.a)(this,e),this.time=t,this.beat=a,this.click=i}));function T(e){var t=Object(k.jsx)(u.a,{icon:b.c}),a=Object(k.jsx)(u.a,{icon:b.d});return Object(k.jsx)("div",{className:"play-row",children:Object(k.jsx)("button",{className:"btn-circle large",onClick:e.onClick,name:"play-button",children:"Start"===e.value?t:a})})}function w(e){return Object(k.jsxs)("div",{className:"settings-row",children:[Object(k.jsxs)("label",{className:"cb-label",children:[Object(k.jsx)("input",{type:"checkbox",name:"major-chords-toggle",checked:e.majorChordsChecked,onChange:e.handleChordChange}),"\xa0Major Chords"]}),Object(k.jsxs)("label",{className:"cb-label",children:[Object(k.jsx)("input",{type:"checkbox",name:"minor-chords-toggle",checked:e.minorChordsChecked,onChange:e.handleChordChange}),"\xa0Minor Chords"]}),Object(k.jsx)("div",{className:"select-wrapper",children:Object(k.jsxs)("select",{value:e.beatsPerBar,onChange:e.handleTempoChange,name:"beat-select",children:[Object(k.jsx)("option",{value:"2",children:"2/4"}),Object(k.jsx)("option",{value:"3",children:"3/4"}),Object(k.jsx)("option",{value:"4",children:"4/4"}),Object(k.jsx)("option",{value:"5",children:"5/4"}),Object(k.jsx)("option",{value:"6",children:"6/4"}),Object(k.jsx)("option",{value:"7",children:"7/4"}),Object(k.jsx)("option",{value:"8",children:"8/4"})]})}),Object(k.jsx)("div",{className:"select-wrapper",children:Object(k.jsxs)("select",{value:e.clicksPerBeat,onChange:e.handleTempoChange,name:"click-select",children:[Object(k.jsx)("option",{value:"1",children:"1 click"}),Object(k.jsx)("option",{value:"2",children:"2 clicks"}),Object(k.jsx)("option",{value:"3",children:"3 clicks"}),Object(k.jsx)("option",{value:"4",children:"4 clicks"}),Object(k.jsx)("option",{value:"5",children:"5 clicks"}),Object(k.jsx)("option",{value:"6",children:"6 clicks"}),Object(k.jsx)("option",{value:"7",children:"7 clicks"})]})})]})}var y=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var i;Object(n.a)(this,a),i=t.call(this,e);g.concat(O);i.state={noteLength:.05,lookahead:25,scheduleAheadTime:.1,tempo:120,maxTempo:240,minTempo:30,nextBeat:0,nextBeatTime:0,nextClick:0,nextClickTime:0,isPlaying:!1,audioUnlocked:!1,noteQueue:[],beatsPerBar:4,clicksPerBeat:1,majorChordsChecked:!0,minorChordsChecked:!0},i.handleTempoChange=i.handleTempoChange.bind(Object(s.a)(i)),i.handleChordChange=i.handleChordChange.bind(Object(s.a)(i)),i.handleClick=i.handleClick.bind(Object(s.a)(i)),i.handleTick=i.handleTick.bind(Object(s.a)(i));var c=window.AudioContext||window.webkitAudioContext||!1;return i.audioContext=new c({sampleRate:44100}),i.unlockAudio(),i.timerWorker=p()(),i.timerWorker.onmessage=function(e){"tick"===e.data&&i.handleTick()},i.timerWorker.postMessage({interval:i.state.lookahead}),i}return Object(i.a)(a,[{key:"scheduleNote",value:function(e){var t=this.audioContext.createOscillator(),a=this.audioContext.createGain();if(t.connect(a),a.connect(this.audioContext.destination),0!==e.beat?t.frequency.value=440:t.frequency.value=880,0!==e.click&&(t.frequency.value=330),0===e.beat&&0===e.click){var n=[];this.state.majorChordsChecked&&(n=n.concat(g)),this.state.minorChordsChecked&&(n=n.concat(O));for(var i=this.state.chord;i===this.state.chord;)i=n[Math.floor(Math.random()*n.length)];this.setState({chord:i})}t.start(this.state.nextClickTime),a.gain.setTargetAtTime(0,this.state.nextClickTime+this.state.noteLength,.015),t.stop(this.state.nextClickTime+2*this.state.noteLength)}},{key:"handleTick",value:function(){var e=this;if(this.state.isPlaying)for(var t=function(){var t=e.state.nextBeat,a=e.state.nextClick,n=60/e.state.tempo,i=e.state.nextBeatTime,s=new f(e.state.nextClickTime,t,a);0===s.click&&(i=s.time+n),e.scheduleNote(s),e.state.clicksPerBeat>1?++a>=e.state.clicksPerBeat&&(a=0,++t>=e.state.beatsPerBar&&(t=0)):(t++,a=0,t>=e.state.beatsPerBar&&(t=0)),e.setState((function(c){return{noteQueue:c.noteQueue.concat(s),nextClickTime:c.nextClickTime+1/e.state.clicksPerBeat*n,nextBeatTime:i,nextBeat:t,nextClick:a}}))};this.state.nextClickTime<this.audioContext.currentTime+this.state.scheduleAheadTime;)t()}},{key:"unlockAudio",value:function(){var e=this.audioContext.createBuffer(1,1,22050),t=this.audioContext.createBufferSource();t.buffer=e,t.start(this.audioContext.currentTime)}},{key:"handleClick",value:function(e){var t=0;switch(e.target.name){case"increment-tempo":return t=parseInt(this.state.tempo)+1,void this.setState((function(e){return{tempo:t>e.maxTempo?e.tempo:t}}));case"decrement-tempo":return t=parseInt(this.state.tempo)-1,void this.setState((function(e){return{tempo:t<e.minTempo?e.tempo:t}}))}if(this.timerWorker.postMessage(this.state.isPlaying?"stop":"start"),this.state.isPlaying)this.audioContext.close(),this.setState((function(e){return{isPlaying:!e.isPlaying,audioUnlocked:!1,noteQueue:[],nextClickTime:0,nextBeat:0,nextClick:0}}));else{var a=window.AudioContext||window.webkitAudioContext||!1;this.audioContext=new a({sampleRate:44100}),this.state.audioUnlocked||this.unlockAudio(),this.setState((function(e){return{isPlaying:!e.isPlaying,audioUnlocked:!0}}))}}},{key:"handleTempoChange",value:function(e){"beat-select"!==e.target.name?"click-select"!==e.target.name?this.setState({tempo:e.target.value}):this.setState({clicksPerBeat:e.target.value}):this.setState({beatsPerBar:e.target.value})}},{key:"handleChordChange",value:function(e){"major-chords-toggle"===e.target.name?this.setState({majorChordsChecked:e.target.checked}):"minor-chords-toggle"===e.target.name&&this.setState({minorChordsChecked:e.target.checked})}},{key:"render",value:function(){return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(x,{chord:this.state.chord,onChange:this.handleTempoChange,onClick:this.handleClick,tempo:this.state.tempo,maxTempo:this.state.maxTempo,minTempo:this.state.minTempo}),Object(k.jsx)(C,{tempo:this.state.tempo,nbt:this.state.nextBeatTime,isplaying:this.state.isPlaying,queue:this.state.noteQueue,audiocontext:this.audioContext,beatsPerBar:this.state.beatsPerBar,theme:this.props.theme}),Object(k.jsx)(T,{value:this.state.isPlaying?"Stop":"Start",onClick:this.handleClick}),Object(k.jsx)(w,{beatsPerBar:this.state.beatsPerBar,clicksPerBeat:this.state.clicksPerBeat,handleTempoChange:this.handleTempoChange,handleChordChange:this.handleChordChange,minorChordsChecked:this.state.minorChordsChecked,majorChordsChecked:this.state.majorChordsChecked})]})}}]),a}(h.a.Component),B=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){return Object(n.a)(this,a),t.call(this,e)}return Object(i.a)(a,[{key:"render",value:function(){return Object(k.jsxs)("header",{className:"navbar",children:[Object(k.jsxs)("div",{className:"logo",children:[Object(k.jsx)(u.a,{icon:b.b}),"\xa0\xa0Metronome"]}),Object(k.jsx)("div",{children:Object(k.jsx)("button",{onClick:this.props.toggleTheme,children:"dark"===this.props.theme?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(u.a,{icon:b.e}),"\xa0\xa0Too dark?"]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(u.a,{icon:b.a}),"\xa0\xa0Too bright?"]})})})]})}}]),a}(h.a.Component),N=function(e){Object(c.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={lightTheme:{background:"#f0f0f0",light:"#ccc"},darkTheme:{background:"#424242",light:"#595959"},theme:"dark"},i.toggleTheme=i.toggleTheme.bind(Object(s.a)(i)),i}return Object(i.a)(a,[{key:"toggleTheme",value:function(){this.setState((function(e){return{theme:"dark"===e.theme?"light":"dark"}}))}},{key:"render",value:function(){return Object(k.jsx)("div",{className:"dark"===this.state.theme?"theme-dark":"theme-light",children:Object(k.jsxs)("div",{className:"app-wrapper",children:[Object(k.jsxs)("div",{className:"app",children:[Object(k.jsx)(B,{onClick:null,toggleTheme:this.toggleTheme,theme:this.state.theme}),Object(k.jsx)(y,{theme:"dark"===this.state.theme?this.state.darkTheme:this.state.lightTheme})]}),Object(k.jsxs)("footer",{children:[Object(k.jsxs)("a",{href:"https://github.com/aviolin/metronome/",target:"_blank",rel:"noreferrer",children:[Object(k.jsx)(u.a,{icon:m.a}),"\xa0\xa0View the source on Github"]}),Object(k.jsx)("p",{children:"\xa9 2021, Arlo Adams"})]})]})})}}]),a}(h.a.Component);d.a.render(Object(k.jsx)(h.a.StrictMode,{children:Object(k.jsx)(N,{})}),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.70b6f8e6.chunk.js.map